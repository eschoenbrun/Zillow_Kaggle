import csv
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
%matplotlib inline

## Load Data
df = pd.read_csv('C:/Users/Stevens/Desktop/BIA 686/zillow/bia_686/data/properties_2016.csv', header='infer')
target = pd.read_csv('C:/Users/Stevens/Desktop/BIA 686/zillow/bia_686/data/train_2016_v2.csv', header='infer')

# Determine data types 
# df.iloc[:, np.r_[22,32,34,49,55]]

# Should we change date from float to datetime?
# pd.to_datetime(prop_data.assessmentyear).dt.year.head(5)
# pd.to_datetime(prop_data.assessmentyear)
# pd.to_datetime(prop_data.taxdelinquencyyear)
# pd.to_datetime(prop_data.yearbuilt)

## Format dates
target.transactiondate = pd.to_datetime(target.transactiondate,format='%Y-%m-%d')

## Join dataframes
joined_data = pd.merge(target,df,on="parcelid",how="left")

# Database characteristics
joined_data.info()
joined_data.describe()
joined_data.dtypes

# Numerical Data
num_cols = ['parcelid','basementsqft',	'bathroomcnt',	'bedroomcnt',	'calculatedbathnbr', 'calculatedfinishedsquarefeet',	'finishedfloor1squarefeet',	'finishedsquarefeet12',	'finishedsquarefeet13',	'finishedsquarefeet15',	'finishedsquarefeet50',	'finishedsquarefeet6',	'fireplacecnt',	'fullbathcnt',	'garagecarcnt',	'garagetotalsqft',	'landtaxvaluedollarcnt',	'lotsizesquarefeet',	'numberofstories',	'poolcnt',	'poolsizesum',	'roomcnt',	'structuretaxvaluedollarcnt',	'taxamount',	'taxvaluedollarcnt',	'threequarterbathnbr',	'unitcnt',	'yardbuildingsqft17',	'yardbuildingsqft26']
num_data = joined_data[num_cols]

# Database characteristics
num_data.info()
num_data.describe()

# Graphs
plt.style.use('fivethirtyeight')
for i, col in enumerate(num_data.columns):
    plt.figure(i)
    plt.subplot(1, 2, 1)
    # Log transformation for skewed data
    sns.distplot(np.log1p(num_data[col].dropna()), color = "orange", kde = True)
    plt.xlabel(col)
    
    plt.subplot(1, 2, 2)
    sns.boxplot(num_data[col].dropna(), orient='v')
    plt.xlabel(col)
    
    plt.tight_layout()
    plt.show()
    